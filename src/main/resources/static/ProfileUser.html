<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	<!--Fontawesome icons for footer-->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
	<link rel="stylesheet" href="style/styles.css">
	<title>IBolit</title>
	<!--JQuery component-->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body onload=saveUserId()>
		<script> function saveUserId() {
		const params = new Proxy(new URLSearchParams(window.location.search), {
  get: (searchParams, prop) => searchParams.get(prop),
});
	var id = params.userId
	if (id) {
		console.log("saving to localstorage" + id)
		localStorage.setItem("userId", id)
	}
	
		}
	</script>
		<!-- Η μπάρα πλοήγησης με εικονίδιο στην αρχή -->
<!-- Η μπάρα πλοήγησης με εικονίδιο στην αρχή -->
		<nav class="navbar navbar-expand-sm navbar-light">
			<div class="container-fluid">						
				<a href="./home.html" class="navbar-brand">
					<img src="pictures/icon.png" alt="Logo" style="width:40px;">
				</a>
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResp">
					<span class="navbar-toggler-icon"></span>
				</button>				
				<div class="collapse navbar-collapse d-flex justify-content-end" id="navbarResp">						
					<ul class="nav">
						<li class="nav-item">
							<a class="nav-link active" href="./Home.html">Home</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="./AboutUs.html">About Us</a>
						</li>
						<li class="nav-item">
						<li class="nav-item">
							<a class="nav-link" href="./ContactUs.html">Contact Us</a>
						</li>					
							<li class="nav-item">
								<a class="nav-link" href="./Login.html">Login</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="./RegistrationForm.html">Register</a>
							</li>
						
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
						  		  
								</a>
								<div class="dropdown-menu">
									<a class="dropdown-item" href="./ProfileUser.html">My Profile</a>
									<a class="dropdown-item" href="./AppointmentForm.html">My Appointments</a>
									<button class="dropdown-item logout-btn" id="logout" name="logout">Logout</button>	     						     		
								</div>								
							</li>															
					</ul>					
				</div>
			</div>
		</nav>
		<section style="margin-left: 20%;margin-right: 20%;">
			<button class="btn btn-success"><a href="AppointmentForm.html">Make An Appointment</a></button>
		<table class="table">
  <thead style="background-color:aliceblue;">
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Status</th>
    </tr>
  </thead>
  <tbody id="appointments_body">
	  <h1>Your appointments will be displayed here</h1>
  </tbody>
</table>
		<button class="btn btn-success" onclick="btnAppointment();">My Appointments</button>
		</section>
		<script>
			function btnAppointment(){
				let userId = localStorage.getItem("userId")
				console.log("userid from local storage " + userId)
				$.ajax({
					url:"/getAppointmentData/listAll/" + userId,
					method:"GET",
					success:function(data)
					{
						console.log(data)
						var body = document.getElementById("appointments_body")
						var appointmentRows = []
						for(appointment of data) {							
							var speciality = document.createElement("td")
							speciality.appendChild(document.createTextNode(appointment.speciality))
							var dates = document.createElement("td")
							dates.appendChild(document.createTextNode(appointment.dates))
							var row = document.createElement("tr")
							row.appendChild(speciality)
							row.appendChild(dates)
							appointmentRows.push(row)
						}
						body.replaceChildren(...appointmentRows)			
						
					},
					error: function(data) {
               		alert("error");
            }});
				};
		</script>
		<table id="tbl-appointment" class="table table-striped">
  <thead>
    <tr>
      <th scope="col"></th>
      <th scope="col"></th>
      <th scope="col"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
		<!--Στοιχεία Επικοινωνίας-->
		<div class="container-fluid py-4 contact-footer">
			<div class="row">
				<div class="col">
					<h2 class="text-center text-dark-green">Contact Information</h2>
				</div>
			</div>

			<div class="row">
				<!--Geolocation-->
				<div class="col-md-6 col-xs-12 my-5">
					<!--Ενσωματομένος χάρτης-->
					<div class="embed-responsive embed-responsive-16by9">
						<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3142.6136818025857!2d23.787996115325125!3d38.03278477971337!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14a198edaaf054d1%3A0x182534b46eb6e4d1!2zzpHOs8-BzqzPhs-Jzr0gMywgzpzOsc-Bzr_Pjc-DzrkgMTUxIDIz!5e0!3m2!1sel!2sgr!4v1621437421649!5m2!1sel!2sgr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
					</div>
				</div>

				<div class="col-md-6 col-xs-12 my-5 text-center">
					<!--Στοιχεία επικοινωνίας με το ΕΟΔΥ Αθήνας. Οι κλάσεις "fas..." είναι για τα εικονίδια τοποθεσίας και τηλεφώνου. Τα πέρνουμε από την βιβλιοθήκη fontawesome.-->
					<h5>Athens EODY</h5>
					<p class="pt-2"><i class="fas fa-map-marker-alt"></i> Agrafon 3-5, Marousi, Postcode 151-23</p>
					<p><i class="fas fa-phone"></i> 210 5212000</p>
				</div>
			</div>
		</div>
	
		<!--Footer-->
		<div class="container-fluid footer-copyright">
			<footer>
				<div class="row">
					<div class="col my-4 text-center">
						<p class="text-white">Copyright &copy; 2023<a class="footer-link" href="https://www.ds.unipi.gr/"> Students of Digital Systems</a></p>
					</div>
				</div>
			</footer>
		</div>

</body>
</html>